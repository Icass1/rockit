---
import "@/styles/default.css";

---
<!doctype html>
<html lang="en" class="dark"></html>

<head>
    <meta charset="UTF-8" />
    <meta name="description" content="FileBrowser login" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="generator" content={Astro.generator} />
    <title>Login</title>
</head>


<body>
	<main class="overflow-hidden h-full w-full" style="background-image:url(/background.jpg); background-repeat:no-repeat; background-size:cover; background-position-y: bottom;">
		<div class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 max-w-md w-full space-y-8 p-8 bg-black bg-opacity-[.92] rounded-xl shadow-lg text-center">
			<div>
				<div class="flex justify-center items-center space-x-2">
					<h2 class="text-3xl font-extrabold text-foreground">Log in to</h2>
					<img src="/logo-banner.png" class="w-1/2" alt="Rock It!"/>
				</div>
				<p class="mt-2 text-sm text-fo">
					Or{" "}
					<a href="/signup" class="font-medium text-primary hover:text-primary/80">
						create a new account
					</a>
				</p>
			</div>
			<form class="mt-8 space-y-6" method="post" action="/api/login">
				<div class="space-y-4">
					<div>
						<input id="username" name="username" autocomplete="username" required class="mt-1 w-4/5 rounded-full text-1xl px-5 py-1 bg-[#202020] text-white" placeholder="Username" />
					</div>
					<div>
						<div class="relative mt-1">
							<input id="password" name="password" type="password" placeholder="Password" class="mt-1 w-4/5 rounded-full text-1xl px-5 py-1 bg-[#202020] text-white" autocomplete="current-password" required />
						</div>
					</div>
				</div>
				<p id="form-error" class="text-white bg-[#ed4337] w-full rounded-md"></p>
				<div class="flex justify-center">
					<button type="submit" class="w-1/3 h-8 rounded-md bg-green-600 flex justify-center items-center">
						Log in
					</button>
				</div>
			</form>
		</div>
		



		<script>
			const errorMessageElement = document.getElementById("form-error")!;

			document.forms[0].addEventListener("submit", async (e) => {
				e.preventDefault();
				errorMessageElement.innerText = "";
				const formElement = e.target as HTMLFormElement;
				const response = await fetch(formElement.action, {
					method: formElement.method,
					body: new FormData(formElement)
				});
				if (response.ok) {
					window.location.href = "/";
				} else {
					errorMessageElement.innerText = (await response.json()).error;
				}
			});
		</script>
		</div>
	</main>
</body>

</html>
